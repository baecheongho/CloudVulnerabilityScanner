from typing import Any
import boto3
import sys
from django.shortcuts import render
from django.http import HttpResponse
from rest_framework.views import APIView

from rest_framework.response import Response
from django.views.decorators.csrf import csrf_exempt
from django.views.generic import ListView
from rest_framework import status
from django.http import Http404
from json import JSONEncoder
import datetime
from django.http import JsonResponse
from django.core import serializers
import json

class DateTimeEncoder(JSONEncoder):
                # Overide the default method
                def default(self, obj: Any) -> Any:
                        if isinstance(obj, (datetime.date, datetime.datetime)):
                                return obj.isoformat()
                        
# AWS Auth configuration for boto3
session = boto3.Session(profile_name='default')
ec2 = boto3.client('ec2',
                        #aws_access_key_id='access_key',
                        #aws_secret_access_key= 'secretkey',
                        #region_name = 'ap-northeast-2'

                            
                        
                        )


class ListView(APIView):
        def get(self,post):
                ec2_list = ec2.describe_instances(

                        #Filters=[
                            
                        #],

        )
                #json_ec2_list = json.dumps(ec2_list, indent=4, cls=DateTimeEncoder)
                #json_post = serializers.serialize('json', ec2_list)
                #return Response(json_post)
                #print(type(ec2_list))
                
                json_ec2_list = json.dumps(ec2_list, cls=DateTimeEncoder)
                #json_ec2_list = json.dumps(ec2_list)
                return Response(json_ec2_list)
                
                return Response("test")
        #re = Response.strftime("%A %d. %B %Y")
        #print(DateTimeEncoder().encode(Response))        
          #ret = json.dumps(ec2_list, indent=4, cls=DateTimeEncoder)
           
       # return HttpResponse(ret, content_type="application/json")

#print("sst")
